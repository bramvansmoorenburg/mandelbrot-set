---
title: "Misiurewicz point finder"
author: "Bram van Smoorenburg"
date: "1 August 2019"
output: html_document
---

newton's method
https://mathr.co.uk/blog/2015-01-26_newtons_method_for_misiurewicz_points.html
```{r}
Fcx=function(c,x){z=0;for (i in 1:x) {z=z^2+c};return(z)}
g2=function(q,p,c){Fcx(c,q+p)-Fcx(c,q)}
h2=function(q,p,c){prod(sapply(0:(q-1),g2,p=p,c=c))}
f2=function(q,p,c){g2(q,p,c)/h2(q,p,c)}
```

derivatives
```{r}
#g2deriv=function(q,p,c){}
h2deriv=function(q,p,c){h2(q,p,c)*prod(sapply(0:(q-1),function(x){g2deriv(x,p,c)/g2(x,p,c)}))}
f2deriv=function(q,p,c){(g2deriv(q,p,c)*h2(q,p,c)-g2(q,p,c)*h2deriv(q,p,c))/((h2(q,p,c))^2)}
```

newton step
```{r}
newc=function(c,q,p){c-f2(q,p,c)/f2deriv(q,p,c)}
```
where c0 is an initial guess

try it
```{r}
c0=complex(real=0,imaginary=-1)
q0=1
p0=2
print(c0)
cnew=c0
for (i in 1:100) {
  cnew=newc(cnew,q0,p0)
  print(cnew)
}
```

